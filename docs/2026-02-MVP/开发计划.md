# 天文主题 Web App 开发计划（MVP，无声音版）

## 1. 项目目标与范围

- 目标：用户进入页面后 3 秒内进入宁静星空体验，无学习成本。
- 周期：7 天完成首个可上线版本。
- 范围：仅覆盖 `MVP-功能清单.md` 中 P0 功能。
- 非目标：不做账号系统、不做后端、不做多场景、不做声音设计。

## 2. 技术栈

| 类别     | 选型                                  | 说明                                  |
| -------- | ------------------------------------- | ------------------------------------- |
| 前端框架 | React + TypeScript + Vite             | 启动快、生态成熟、便于后续扩展        |
| 动画渲染 | Canvas 2D API                         | 满足星空/流星动画，性能与复杂度平衡好 |
| 状态管理 | React Hooks（必要时 Zustand）         | MVP 保持轻量，避免过度工程化          |
| 样式方案 | CSS Modules + CSS Variables           | 便于主题参数、呼吸节奏统一管理        |
| 测试     | Vitest + Testing Library + Playwright | 单测 + 关键流程端到端验证             |
| 代码质量 | ESLint + Prettier                     | 统一风格，减少低级错误                |
| 部署     | Vercel 或 Netlify                     | 静态站点快速上线                      |

## 3. 功能模块划分

| 模块              | 核心职责                                | 完成标准                           |
| ----------------- | --------------------------------------- | ---------------------------------- |
| App Shell         | 全屏承载、首屏加载、基础布局            | 首屏无打断，3 秒内可交互           |
| Starfield Engine  | 星空背景、星点闪烁、慢速漂移、90 秒循环 | 动画连续稳定、视觉节奏平缓         |
| Meteor Effect     | 长按 1 秒触发流星                       | 触发准确，单次播放自然不卡顿       |
| Quote Module      | 文案随机展示、轻触切换、淡入淡出        | 文案逻辑稳定、切换无闪烁           |
| Breathing Visual  | 整体亮度轻微周期起伏                    | 开关可控，默认开启，不刺眼         |
| Settings Panel    | 仅两个开关：文案显示/呼吸模式           | 操作简单，状态即时生效             |
| Lifecycle Guard   | 前后台切换时动画暂停与恢复              | 无黑屏、无状态错乱                 |
| Performance Guard | 帧率监控与设备分级策略                  | 中端机尽量 60fps，最低不低于 30fps |

## 4. 建议工程结构

```txt
src/
  app/
    App.tsx
    App.css
  features/
    starfield/
    meteor/
    quotes/
    breathing/
    settings/
  shared/
    hooks/
    utils/
    constants/
  assets/
    quotes.json
```

## 5. 开发阶段计划（7 天）

| 天数  | 任务重点                               | 交付产物           |
| ----- | -------------------------------------- | ------------------ |
| Day 1 | 项目初始化、工程化配置、全屏壳层       | 可运行项目骨架     |
| Day 2 | 星空引擎实现（星点、闪烁、漂移、循环） | 基础星空场景       |
| Day 3 | 交互实现（轻触切文案、长按触发流星）   | 两个核心交互可用   |
| Day 4 | 文案模块、设置面板（2 开关）           | 文案与设置联动可用 |
| Day 5 | 呼吸模式、生命周期恢复                 | 后台恢复稳定       |
| Day 6 | 移动端适配、性能优化、关键测试         | 达到性能目标基线   |
| Day 7 | E2E 验收、修复、上线部署               | 可访问线上版本     |

## 6. 验收标准（对齐 MVP）

- 进入页面 3 秒内出现可交互星空。
- 无登录、无引导流程，进入即体验。
- 轻触可切换文案，长按 1 秒触发流星。
- 设置面板仅两个开关且立即生效。
- 前后台切换后动画恢复正常。
- iOS Safari / Android Chrome 可正常使用。
- 中端机体验流畅，最低帧率不低于 30fps。

## 7. 风险与应对

| 风险         | 影响                   | 应对策略                             |
| ------------ | ---------------------- | ------------------------------------ |
| 低端机掉帧   | 动画卡顿，影响宁静体验 | 分层降级：减少星点数量、降低刷新压力 |
| 长按误触发   | 交互体验不稳定         | 统一长按阈值（1 秒）+ 防抖           |
| 文案切换突兀 | 体验跳变               | 固定淡入淡出时长，统一过渡曲线       |
| 页面恢复异常 | 回前台黑屏或状态错乱   | 用 `visibilitychange` 统一恢复逻辑   |

## 8. 最小上线清单

- 本地构建通过，关键测试通过。
- 真机验证（iOS/Android）通过。
- 部署到 Vercel/Netlify，得到可访问链接。
- 同步 `README` 的启动、构建、部署说明。
